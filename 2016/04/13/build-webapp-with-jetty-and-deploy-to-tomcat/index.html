<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="每天还是要花点时间来总结的"><meta name="google-site-verification" content="6GTeiOhqimfTtuUIQtS8CqdXJzM4lPPMeXjbvNAsm5w"><title>使用jetty开发Web项目并布署到tomcat7 | 自省|反思</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/normalize.min.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/pure-min.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css?v=0.0.0"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="/js/jquery.min.js?v=0.0.0"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">使用jetty开发Web项目并布署到tomcat7</h1><a id="logo" href="/.">自省|反思</a><p class="description">How many things have you done to make your life better?</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">使用jetty开发Web项目并布署到tomcat7</h1><div class="post-content"><h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>在Eclipse时代，开发一个web项目一般都会在本地安装tomcat服务器来看运行的效果。可能是我对Eclipse不熟悉，以前使用Eclipse开发Web项目的时候，经常性的修改了Jsp页面，在Eclipse里启动tomcat的时候，发现刚刚在Jsp页面做的修改并没有生效，通常的解决办法是Clean一下，然后再ReBuild，再Redeploy一下才能看到最新的效果。更郁闷的是，如果Jsp页面里面的引用了JS文件，直接修改JS文件也不会生效，还得在Jsp页面里面在引用JS文件的地方加上XXX.js?v=0.1之类的，很是蛋疼。</p>
<p>后来听说有Intellij Idea这种号称比Eclipse高到不知道哪里去了的IDE，又听说了maven这种约定大于配置的的开发方式。于是整个世界清静了。</p>
<p>最近有个新的项目需求，正好记录一下在开发Web项目中，如何使用Jetty，以及如何部署到tomcat。</p>
<h2 id="二、开发阶段"><a href="#二、开发阶段" class="headerlink" title="二、开发阶段"></a>二、开发阶段</h2><ol>
<li>新建一个maven项目，选择 <code>maven-archetype-webapp</code>；</li>
<li>在pom.xml的 <code>build-&gt;plugins</code> 节点下添加jetty的插件：<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.eclipse.jetty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jetty-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.3.7.v20160115<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">         <span class="tag">&lt;<span class="name">scanIntervalSeconds</span>&gt;</span>5<span class="tag">&lt;/<span class="name">scanIntervalSeconds</span>&gt;</span></div><div class="line">         <span class="tag">&lt;<span class="name">webApp</span>&gt;</span></div><div class="line">             <span class="tag">&lt;<span class="name">contextPath</span>&gt;</span>/<span class="tag">&lt;/<span class="name">contextPath</span>&gt;</span></div><div class="line">         <span class="tag">&lt;/<span class="name">webApp</span>&gt;</span></div><div class="line">         <span class="tag">&lt;<span class="name">httpConnector</span>&gt;</span></div><div class="line">             <span class="tag">&lt;<span class="name">port</span>&gt;</span>7070<span class="tag">&lt;/<span class="name">port</span>&gt;</span></div><div class="line">         <span class="tag">&lt;/<span class="name">httpConnector</span>&gt;</span></div><div class="line">     <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>其中：<code>scanIntervalSeconds</code> 是指每隔多少秒扫描一下文件。如果只是修改JSP文件，只要jetty启动了，可以在页面直接刷新就能看到效果，不需要像使用tomcat那样还要重新启动，节省时间。<br><code>contextPath</code> 是指部署到根目录，就是说访问的时候只需要在浏览器里面输入：<code>http://localhost:7070</code> 就可以了。当然也可以指定访问的目录。这个搞Web开发的都知道，不用多说了。<br><code>port</code> 端口</p>
<ol>
<li>在项目目录下执行如下命令：<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mvn jetty:<span class="keyword">run</span><span class="bash"></span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>然后看到 <code>[INFO] Started Jetty Server</code> 之类的字样，就表示jetty已经启动成功.</p>
<h2 id="三、部署阶段"><a href="#三、部署阶段" class="headerlink" title="三、部署阶段"></a>三、部署阶段</h2><ol>
<li>在pom.xml里面加入tomcat7-maven-plugin的插件引用<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://localhost:8080/manager/text<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">server</span>&gt;</span>tomcatserver<span class="tag">&lt;/<span class="name">server</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">username</span>&gt;</span>tomcat<span class="tag">&lt;/<span class="name">username</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">password</span>&gt;</span>tomcat<span class="tag">&lt;/<span class="name">password</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">path</span>&gt;</span>/test<span class="tag">&lt;/<span class="name">path</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>特别要注意<code>configuration</code>里面的内容，这些配置是要和后面tomcat的配置挂钩的。<br>上面的配置是针对tomcat7的，如果是6的话，可以不要后面的text,写成 <code>http://localhost:8080/manager</code> 也是可以的。<a href="http://tomcat.apache.org/maven-plugin-trunk/index.html" title="http://tomcat.apache.org/maven-plugin-trunk/index.html" target="_blank" rel="external">链接</a></p>
<ol>
<li>以部署到本地tomcat为例，我这里测试的版本是tomcat7.0.65.打开 <code>conf/tomcat-users.xml</code> 文件，可以看到这里有对tomcat的用户的配置，默认是注释掉的。现在我们要开启它，记住：要与1中的 <code>username</code> 和 <code>password</code> 对应起来。<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-script"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-jmx"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-status"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-gui"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"tomcat"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">username</span>=<span class="string">"tomcat"</span> <span class="attr">password</span>=<span class="string">"tomcat"</span> <span class="attr">roles</span>=<span class="string">"tomcat,manager-gui,manager-jmx,manager-status,manager-script"</span>/&gt;</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>现在就可以启动tomcat了。在浏览器中输入tomcat的访问地址和端口，就会出现tomcat的管理界面，在管理站点的时候，会提示需要账号密码，这个时候，你懂的。<br>PS：最开始在google上找的时候，对Tomcat这个用户只添加了manager-gui这个权限，是没有成功的。后来索性把注释掉的权限都打开并且给了tomcat这个用户之后，才成功。具体原因，暂时不明。</p>
<ol>
<li><p>这里还需要对maven的settings.xml文件要做一个配置，这个settings.xml文件在maven的安装目录的conf目录下。打开它，找到<code>&lt;servers&gt;&lt;/servers&gt;</code>这个节点，在里面输入：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>tomcatserver<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">username</span>&gt;</span>tomcat<span class="tag">&lt;/<span class="name">username</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">password</span>&gt;</span>tomcat<span class="tag">&lt;/<span class="name">password</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>然后在启动了tomcat之后，在项目目录下输入：</p>
</li>
</ol>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">mvn </span>tomcat7:redeploy</div></pre></td></tr></table></figure>
<p>执行完这个命令没有报错的话，应该就能在浏览器中访问<code>http://localhost:8080/test</code>看到效果了</p>
</div></div><div data-thread-key="2016/04/13/build-webapp-with-jetty-and-deploy-to-tomcat/" data-title="使用jetty开发Web项目并布署到tomcat7" data-url="http://yoursite.com/2016/04/13/build-webapp-with-jetty-and-deploy-to-tomcat/" data-author-key="1" class="ds-thread"></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">自省|反思.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'waitd'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>